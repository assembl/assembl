#import "./fragments/VoteSession.graphql"

fragment tokenVoteSpecification on TokenVoteSpecification {
  id
  voteSessionId
  instructions(lang: $lang)
  titleEntries {
    ...langStringEntry
  }
  instructionsEntries {
    ...langStringEntry
  }
  isCustom
  exclusiveCategories
  tokenCategories {
    id
    totalNumber
    typename
    title(lang: $lang)
    titleEntries {
      ...langStringEntry
    }
    color
  }
  voteSpecTemplateId
  voteType
  myVotes {
    ... on TokenVote {
      voteValue
      proposalId
      tokenCategoryId
    }
  }
}

fragment numberGaugeVoteSpecification on NumberGaugeVoteSpecification {
  id
  voteSessionId
  instructions(lang: $lang)
  titleEntries {
    ...langStringEntry
  }
  instructionsEntries {
    ...langStringEntry
  }
  isCustom
  minimum
  maximum
  nbTicks
  unit
  voteSpecTemplateId
  voteType
  myVotes {
    ... on GaugeVote {
      selectedValue: voteValue
      proposalId
    }
  }
}

fragment gaugeVoteSpecification on GaugeVoteSpecification {
  id
  voteSessionId
  instructions(lang: $lang)
  titleEntries {
    ...langStringEntry
  }
  instructionsEntries {
    ...langStringEntry
  }
  isCustom
  choices {
    id
    value
    label(lang: $lang)
    labelEntries {
      ...langStringEntry
    }
  }
  voteSpecTemplateId
  voteType
  myVotes {
    ... on GaugeVote {
      selectedValue: voteValue
      proposalId
    }
  }
}

query VoteSession($discussionPhaseId: Int!, $lang: String!) {
  voteSession(discussionPhaseId: $discussionPhaseId) {
    id
    ...voteSessionGlobals
    ...voteSessionLangstringsEntries
    title(lang: $lang)
    subTitle(lang: $lang)
    instructionsSectionTitle(lang: $lang)
    instructionsSectionContent(lang: $lang)
    propositionsSectionTitle(lang: $lang)
    proposals {
      ... on Idea {
        id
        title(lang: $lang)
        description(lang: $lang)
        titleEntries {
          ...langStringEntry
        }
        descriptionEntries {
          ...langStringEntry
        }
        order
      }
      modules: voteSpecifications {
        ...tokenVoteSpecification
        ...numberGaugeVoteSpecification
        ...gaugeVoteSpecification
      }
    }
    modules: voteSpecifications {
      ...tokenVoteSpecification
      ...numberGaugeVoteSpecification
      ...gaugeVoteSpecification
    }
  }
}
