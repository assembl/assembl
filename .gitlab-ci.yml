image: python:2.7

cache:
  paths:
    - assembl/static2/node_modules/

test_frontend:
  before_script:
    - apt-get update -qq
    - apt-get remove -y -qq cmdtest
    - apt-get install -y -qq apt-transport-https
    - wget -qO- https://deb.nodesource.com/setup_8.x | bash -
    - apt-get install -y nodejs
    - curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | apt-key add -
    - echo "deb https://dl.yarnpkg.com/debian/ stable main" | tee /etc/apt/sources.list.d/yarn.list
    - apt-get update -qq
    - apt-get install -y -qq yarn
    - cd assembl/static2
    - yarn
  script:
    - yarn run test
    - yarn run eslint
    - yarn run stylelint
    - yarn run flow

# push to master:
#   stage: deploy
#   only:
#     - develop
#   script:
#     - /bin/bash scripts/git-push https://$GITHUB_ACCESS_TOKEN@github.com/assembl/assembl.git
#   when: on_success
